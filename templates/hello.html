<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Document</title>
  <script type="text/javascript" src="//code.jquery.com/jquery-1.4.2.min.js"></script>
  <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/socket.io/1.3.5/socket.io.min.js"></script>
  <script type="text/javascript" charset="utf-8">
        $(document).ready(function() {
        namespace = '/test'; //main.pyで指定したnamespace
        var socket = io.connect(location.protocol + '//' + document.domain + namespace);

        //テキストエリアはこちらで受信。main.py側からmy_content宛に送られたデータを受け取る
        socket.on('my_content', function(msg) {
            $("#rcv").append("<li>" + msg.data + "</li>") // <div id="place"></div>内に、受け取ったdataを挿入します。
        });

        //htmlのフォームがsubmitされた時に、main.pyのreceive_content宛にテキストエリアのid="input_data"の値を送信します。
        $('form#broadcast').submit(function(event) {
            socket.emit('my_broadcast_event', {data: $('#broadcast_data').val()});
            return false;
        });

    });
  </script>
</head>
<body>
  <h1>Flaskでechoサーバー☆</h1>
  <form id="broadcast" method="POST" action='#'>
    <input type="text" name="broadcast_data" id="broadcast_data" placeholder="Message">
    <input type="submit" value="Broadcast">
  </form>
  <ul id="rcv"></ul>
</body>
</html>
